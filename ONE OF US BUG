local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local ProximityPromptService = game:GetService("ProximityPromptService")
local LocalPlayer = Players.LocalPlayer

_G.AuraRange = 150 
_G.AutoTaskAuraEnabled = true

local function ForceInstantInteractionV3(prompt)
    if not prompt or not prompt:IsA("ProximityPrompt") then return end
    
    prompt.HoldDuration = 0
    prompt.ClickablePrompt = true
    prompt.Enabled = true
    
    task.spawn(function()
        prompt:InputHoldBegin()
        
        task.wait(0.01)
        
        prompt:InputHoldEnd()
        
        if fireproximityprompt then
            fireproximityprompt(prompt)
        end
        
        VirtualInputManager:SendKeyEvent(true, prompt.KeyboardKeyCode, false, game)
        task.wait(0.02)
        VirtualInputManager:SendKeyEvent(false, prompt.KeyboardKeyCode, false, game)
    end)
end

local function ProcessAuraInteractionsV3()
    local Character = LocalPlayer.Character
    if not Character or not Character:FindFirstChild("HumanoidRootPart") then return end
    
    local myPos = Character.HumanoidRootPart.Position
    
    for _, prompt in pairs(Workspace:GetDescendants()) do
        if prompt:IsA("ProximityPrompt") then
            local parent = prompt.Parent
            if parent and parent:IsA("BasePart") then
                local distance = (parent.Position - myPos).Magnitude
                
                if distance <= _G.AuraRange then
                    ForceInstantInteractionV3(prompt)
                end
            end
        end
    end
end

local auraLoop = RunService.Heartbeat:Connect(function()
    if _G.AutoTaskAuraEnabled == true then
        pcall(function()
            ProcessAuraInteractionsV3()
        end)
    end
end)

ProximityPromptService.PromptButtonHoldBegan:Connect(function(prompt)
    if _G.AutoTaskAuraEnabled then
        prompt.HoldDuration = 0
    end
end)
